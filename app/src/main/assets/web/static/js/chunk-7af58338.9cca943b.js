(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7af58338"],{"104b":function(e,a,t){"use strict";t("d3b7"),t("3ca3"),t("ddb0"),t("2b3d"),t("9861");var i=t("ddfe"),l=t("21a6"),n={downloadInterval:2e3,downloadTimer:null,filePath:[],saveFileName:null,mainType:null,subType:null,isZip:!0,callback:null,packageCallback:null,autoDownload:!0,downloadFile:function(){Object(i["a"])(n.filePath,n.isZip,n.mainType,n.subType).then((function(e){var a="application/zip";"media"===n.mainType&&"audio"===n.subType?a="audio/mp3":"media"===n.mainType&&"video"===n.subType?a="audio/mp4":"media"===n.mainType&&"image"===n.subType&&(a="image/png");var t=new Blob([e],{type:a});n.saveFileName&&Object(l["saveAs"])(t,n.saveFileName),n.callback&&n.callback(n.saveFileName?n.saveFileName:window.URL.createObjectURL(t))}))},doPackageFile:function(){var e=this;Object(i["d"])(n.filePath,n.isZip,n.mainType,n.subType).then((function(a){a.code&&(200!=a.code?e.msgError(a.msg):(n.filePath=[],n.filePath.push(a.data.filePath),a.data.ready?(n.packageCallback&&n.packageCallback(a.data),n.autoDownload&&n.downloadFile()):n.startDownloadTimer()))}))},startDownload:function(e,a,t,i,l){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,r=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];n.filePath=e,n.isZip=o,n.mainType=a,n.subType=t,n.saveFileName=i,n.callback=l,n.packageCallback=s,n.autoDownload=r,n.doPackageFile()},startDownloadTimer:function(){null==n.downloadTimer&&setTimeout((function(){n.doPackageFile()}),n.downloadInterval)}};a["a"]=n},"4a12":function(e,a,t){"use strict";var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v(e._s(e.buttonName))]),t("el-dialog",{attrs:{title:"上传文件",visible:e.open,width:"700px","append-to-body":""},on:{"update:visible":function(a){e.open=a}}},[t("div",{staticStyle:{"margin-bottom":"10px"}},[t("span",[e._v("文件名：")]),t("el-input",{attrs:{placeholder:"文件名"},model:{value:e.fileName,callback:function(a){e.fileName=a},expression:"fileName"}})],1),t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:e.uploadUrl,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.onUploadSuccess,"on-change":e.onChangeFile,"file-list":e.fileList,"auto-upload":!1,headers:e.headers,accept:e.fileAccept,limit:1}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"danger"},on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},l=[],n=(t("b0c0"),t("1bb3")),o={name:"uploadFile",props:{fileAccept:{type:String,default:"*.*"},buttonName:{type:String,default:"上传"}},data:function(){return{loading:!0,open:!1,fileList:[],uploadedFileList:[],uploadUrl:"/file/upload",headers:{Authorization:"Bearer "+Object(n["a"])()},fileName:"",statusOptions:[{value:!1,label:"文件"},{value:!0,label:"目录"}]}},created:function(){},methods:{cancel:function(){this.open=!1},handleAdd:function(){this.uploadedFileList=[],this.open=!0},submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(e,a){console.log(e,a)},handlePreview:function(e){console.log(e)},onUploadSuccess:function(e){200===e.code&&(e.data.fileName=this.fileName,this.uploadedFileList.push(e.data.filePath),this.$emit("onUploadFile",this.uploadedFileList),this.$emit("onUploadFileDetail",e),this.open=!1)},onChangeFile:function(e,a){this.fileName||(this.fileName=e.name)}}},s=o,r=t("2877"),d=Object(r["a"])(s,i,l,!1,null,null,null);a["a"]=d.exports},b0bd:function(e,a,t){"use strict";function i(e,a){var t={deviceType:7,deviceId:null,parentNo:null,phoneNo:null,commandId:e,ipAddress:null,macAddress:null,data:a};return t}t.d(a,"a",(function(){return i}))},ddfe:function(e,a,t){"use strict";t.d(a,"b",(function(){return l})),t.d(a,"a",(function(){return n})),t.d(a,"d",(function(){return o})),t.d(a,"c",(function(){return s}));var i=t("70f0");function l(e,a,t,l){var n={commandId:"maintain-req-get-file-list",data:{dir:e,mainType:a,subType:t,withDir:l}};return Object(i["a"])({url:"/maintain/custom",method:"post",data:n})}function n(e,a,t,l){var n={fileList:e,zipAll:a,mainType:t,subType:l};return Object(i["a"])({url:"/file/download",method:"post",data:n,responseType:"blob"})}function o(e,a,t,l){var n={fileList:e,zipAll:a,mainType:t,subType:l},o={commandId:"maintain-req-package-file",data:n};return Object(i["a"])({url:"/maintain/custom",method:"post",data:o})}function s(e){var a={commandId:"maintain-req-operate-file",data:e};return Object(i["a"])({url:"/maintain/custom",method:"post",data:a})}},e5e3:function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"app-container"},[t("el-row",{staticClass:"mb8",attrs:{gutter:10}},[t("el-col",{attrs:{span:1.5}},[t("upload-file",{attrs:{fileAccept:e.fileAccept},on:{onUploadFileDetail:e.onUploadFileDetail}})],1)],1),t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleTabClick},model:{value:e.tabsActiveName,callback:function(a){e.tabsActiveName=a},expression:"tabsActiveName"}},[t("el-tab-pane",{attrs:{label:"铃声",name:"ring"}}),t("el-tab-pane",{attrs:{label:"广播音频",name:"multicast"}})],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tables",attrs:{data:e.list},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"名称",align:"left",prop:"name"}}),t("el-table-column",{attrs:{label:"文件大小",align:"center",prop:"size",formatter:e.fileSizeFormat}}),t("el-table-column",{attrs:{label:"类型",align:"center",prop:"type"}}),t("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-download"},on:{click:function(t){return e.downloadFile(a.row)}}},[e._v("下载")]),t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-play"},on:{click:function(t){return e.onPlayOnline(a.row)}}},[e._v("播放")])]}}])})],1),t("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(a){return e.$set(e.queryParams,"pageNum",a)},"update:limit":function(a){return e.$set(e.queryParams,"pageSize",a)},pagination:e.getList}}),t("div",{staticStyle:{width:"100%"}},[e.playFile.show?t("div",{attrs:{id:"aplayer"}}):e._e()])],1)},l=[],n=t("5530"),o=(t("d81d"),t("b0c0"),t("70f0")),s=t("b0bd");function r(e,a,t){var i={currentPage:e,pageSize:a,use:t};return Object(o["a"])({url:"/business/custom",method:"post",data:Object(s["a"])("req-list-attachment",i)})}function d(e){var a={updateType:0,totalLength:1,list:[]};return a.list.push(e),Object(o["a"])({url:"/business/custom",method:"post",data:Object(s["a"])("req-update-attachment",a)})}var u=t("104b"),c=t("4a12"),p=t("9f61"),m=t.n(p),h=(t("764d"),t("9ee1")),f="1",b="ring",g="0",y="multicast",v={name:"attachmentFile",components:{uploadFile:c["a"],APlayer:m.a},data:function(){return{playFile:{name:"",url:"",show:!0,cover:t("811c"),artist:"广播音频"},nextPlayFile:null,playerInfo:{fixed:!1,listFolded:!0,autoplay:!0,preload:"auto",loop:"all",order:"list"},ap:null,fileAccept:"*.mp3",loading:!0,ids:[],multiple:!0,showSearch:!0,total:0,list:[],open:!1,dateRange:[],defaultSort:{prop:"operTime",order:"descending"},form:{},queryParams:{pageNum:1,pageSize:10,use:f},tabsActiveName:b}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.tabsActiveName===b?this.queryParams.use=f:this.tabsActiveName===y&&(this.queryParams.use=g),r(this.queryParams.pageNum,this.queryParams.pageSize,this.queryParams.use).then((function(a){console.log(a),200===a.code?e.list=a.data.list:e.msgError(a.msg)})),this.loading=!1},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.operId})),this.multiple=!e.length},handleView:function(e){this.open=!0,this.form=e},downloadFile:function(e){var a=e.name+e.path.substring(e.path.lastIndexOf(".")),t=[];t.push(e.path),this.$modal.loading("数据下载中..."),u["a"].startDownload(t,"media","audio",a,this.downloadFinished,!1)},downloadFinished:function(){this.$modal.closeLoading()},onUploadFileDetail:function(e){var a=this;if(200==e.code){var t=f;this.tabsActiveName===b?t=f:this.tabsActiveName===y&&(t=g);var i={use:t,path:e.data.filePath,name:e.data.fileName,size:e.data.length,type:e.data.filePath.substring(e.data.filePath.lastIndexOf(".")+1)};d(i).then((function(e){a.getList()}))}},onPlayOnline:function(e){this.nextPlayFile=e;var a=[];a.push(e.path),u["a"].startDownload(a,"media","audio",null,this.OnPlayReady,!1,null,!0)},OnPlayReady:function(e){this.playFile.name=this.nextPlayFile.name,this.playFile.url=e,this.show=!0,this.initAudio()},initAudio:function(){this.ap?(this.ap.list.clear(),this.ap.list.add(this.playFile),this.ap.play()):(this.ap=new m.a(Object(n["a"])({container:document.getElementById("aplayer"),audio:this.playFile},this.info)),this.ap.play())},fileSizeFormat:function(e){return Object(h["d"])(parseInt(e.size))},handleTabClick:function(){this.getList()}}},w=v,F=t("2877"),P=Object(F["a"])(w,i,l,!1,null,null,null);a["default"]=P.exports}}]);