(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6bea54bc"],{"104b":function(e,t,a){"use strict";a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861");var n=a("ddfe"),i=a("21a6"),o={downloadInterval:2e3,downloadTimer:null,filePath:[],saveFileName:null,mainType:null,subType:null,isZip:!0,callback:null,packageCallback:null,autoDownload:!0,downloadFile:function(){Object(n["a"])(o.filePath,o.isZip,o.mainType,o.subType).then((function(e){var t="application/zip";"media"===o.mainType&&"audio"===o.subType?t="audio/mp3":"media"===o.mainType&&"video"===o.subType?t="audio/mp4":"media"===o.mainType&&"image"===o.subType&&(t="image/png");var a=new Blob([e],{type:t});o.saveFileName&&Object(i["saveAs"])(a,o.saveFileName),o.callback&&o.callback(o.saveFileName?o.saveFileName:window.URL.createObjectURL(a))}))},doPackageFile:function(){var e=this;Object(n["d"])(o.filePath,o.isZip,o.mainType,o.subType).then((function(t){t.code&&(200!=t.code?e.msgError(t.msg):(o.filePath=[],o.filePath.push(t.data.filePath),t.data.ready?(o.packageCallback&&o.packageCallback(t.data),o.autoDownload&&o.downloadFile()):o.startDownloadTimer()))}))},startDownload:function(e,t,a,n,i){var r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];o.filePath=e,o.isZip=r,o.mainType=t,o.subType=a,o.saveFileName=n,o.callback=i,o.packageCallback=l,o.autoDownload=s,o.doPackageFile()},startDownloadTimer:function(){null==o.downloadTimer&&setTimeout((function(){o.doPackageFile()}),o.downloadInterval)}};t["a"]=o},"45d6":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a("70f0"),i=a("5831");function o(){var e={commandId:"maintain-req-device-base-info"};return Object(n["a"])({url:"/maintain/custom",method:"post",data:e})}function r(){var e={commandId:"maintain-req-net-config"};return Object(n["a"])({url:"/maintain/custom",method:"post",data:e})}function l(){var e={commandId:"maintain-req-time-config"};return Object(n["a"])({url:"/maintain/custom",method:"post",data:e})}function s(e){var t={commandId:"maintain-req-update-ip-address",data:e};return Object(i["a"])({url:"/maintain/custom",method:"post",data:t})}function c(e){var t={commandId:"maintain-req-update-time",data:e};return Object(i["a"])({url:"/maintain/custom",method:"post",data:t})}function d(){var e={commandId:"maintain-req-screen-capture",data:{}};return Object(i["a"])({url:"/maintain/custom",method:"post",data:e})}},5831:function(e,t,a){"use strict";var n=a("53ca"),i=(a("fb6a"),a("e9c4"),a("d3b7"),a("caad"),a("2532"),a("bc3a")),o=a.n(i),r=a("5c96"),l=a("3048"),s=a("1bb3"),c=a("e6f3"),d=a("9ee1"),u=a("1908"),m={show:!1};o.a.defaults.headers["Content-Type"]="application/json;charset=utf-8";var p=o.a.create({baseURL:"",timeout:1e4});p.interceptors.request.use((function(e){var t=!1===(e.headers||{}).isToken,a=!1===(e.headers||{}).repeatSubmit;if(Object(s["a"])()&&!t&&(e.headers["Authorization"]="Bearer "+Object(s["a"])()),"get"===e.method&&e.params){var i=e.url+"?"+Object(d["k"])(e.params);i=i.slice(0,-1),e.params={},e.url=i}if(!a&&("post"===e.method||"put"===e.method)){var o={url:e.url,data:"object"===Object(n["a"])(e.data)?JSON.stringify(e.data):e.data,time:(new Date).getTime()},r=u["a"].session.getJSON("sessionObj");if(void 0===r||null===r||""===r)u["a"].session.setJSON("sessionObj",o);else{var l=r.url,c=r.data,m=r.time,p=1e3;if(c===o.data&&o.time-m<p&&l===o.url){var f="数据正在处理，请勿重复提交";return console.warn("[".concat(l,"]: ")+f),Promise.reject(new Error(f))}u["a"].session.setJSON("sessionObj",o)}}return e}),(function(e){console.log(e),Promise.reject(e)})),p.interceptors.response.use((function(e){var t=e.data.code||200,a=c["a"][t]||e.data.msg||c["a"]["default"];return"blob"===e.request.responseType||"arraybuffer"===e.request.responseType?e.data:401===t?(m.show||(m.show=!0,r["MessageBox"].confirm("登录状态已过期，您可以继续留在该页面，或者重新登录","系统提示",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then((function(){m.show=!1,l["a"].dispatch("LogOut").then((function(){location.href="/index"}))})).catch((function(){m.show=!1}))),Promise.reject("无效的会话，或者会话已过期，请重新登录。")):500===t?(Object(r["Message"])({message:a,type:"error"}),Promise.reject(new Error(a))):200!==t?(r["Notification"].error({title:a}),Promise.reject("error")):e.data}),(function(e){console.log("err"+e);var t={},a=e.message;return"Network Error"==a?(a="后端接口连接异常",t.code=500):a.includes("timeout")?(a="系统接口请求超时",t.code=500):a.includes("Request failed with status code")&&(e.response&&e.response.data&&!e.response.data.msg?(a=e.response.data.msg,t.code=500):(a="系统接口"+a.substr(a.length-3)+"异常",t.code=e.response.status)),t.message=a,t})),t["a"]=p},ddfe:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return l}));var n=a("70f0");function i(e,t,a,i){var o={commandId:"maintain-req-get-file-list",data:{dir:e,mainType:t,subType:a,withDir:i}};return Object(n["a"])({url:"/maintain/custom",method:"post",data:o})}function o(e,t,a,i){var o={fileList:e,zipAll:t,mainType:a,subType:i};return Object(n["a"])({url:"/file/download",method:"post",data:o,responseType:"blob"})}function r(e,t,a,i){var o={fileList:e,zipAll:t,mainType:a,subType:i},r={commandId:"maintain-req-package-file",data:o};return Object(n["a"])({url:"/maintain/custom",method:"post",data:r})}function l(e){var t={commandId:"maintain-req-operate-file",data:e};return Object(n["a"])({url:"/maintain/custom",method:"post",data:t})}},f7a2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"danger",plain:"",disabled:0==e.ids.length},on:{click:e.handleDeleteFile}},[e._v("删除文件")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleCaptureScrren}},[e._v("截屏")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tables",attrs:{data:e.list},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{label:"名称",align:"left",prop:"name"}}),a("el-table-column",{attrs:{label:"生成时间",align:"left",prop:"name",formatter:e.fileTimeFormat}}),a("el-table-column",{attrs:{label:"文件大小",align:"center",prop:"length",formatter:e.fileSizeFormat}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-download"},on:{click:function(a){return e.downloadLog(t.row)}}},[e._v("下载")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-eye-open"},on:{click:function(a){return e.onShowOnline(t.row)}}},[e._v("在线查看")])]}}])})],1),a("el-dialog",{attrs:{title:"截屏详情",visible:e.playFile.show,width:"700px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.playFile,"show",t)}}},[a("el-image",{attrs:{src:e.playFile.url}})],1)],1)},i=[],o=(a("ac1f"),a("5319"),a("b0c0"),a("d81d"),a("ddfe")),r=a("104b"),l=a("45d6"),s=a("9ee1"),c=3,d={name:"fileManager",data:function(){return{loading:!0,ids:[],multiple:!0,showSearch:!0,total:0,list:[],open:!1,dateRange:[],defaultSort:{prop:"operTime",order:"descending"},form:{},queryParams:{pageNum:1,pageSize:10,dir:"screen_capture",mainType:"other",subType:"any",withDir:!0},statusOptions:[{value:!1,label:"文件"},{value:!0,label:"目录"}],nextPlayFile:null,playFile:{name:"",url:"",show:!1}}},created:function(){this.getList()},methods:{getList:function(){var e=this;Object(o["b"])(this.queryParams.dir,this.queryParams.mainType,this.queryParams.subType,this.queryParams.withDir).then((function(t){console.log(t),200===t.code?e.list=t.data:e.msgError(t.msg)})),this.loading=!1},fileTimeFormat:function(e){var t=e.name.replace(".png",""),a=Object(s["c"])(t,"yyyyMMdd_HHmmss");return console.log(a),Object(s["e"])("yyyy年MM月dd日 HH:mm:ss",a,!0)},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.filePath})),this.multiple=!e.length},downloadLog:function(e){var t=e.name,a=[];a.push(e.filePath),this.$modal.loading("数据下载中..."),r["a"].startDownload(a,"media","image",t,this.downloadFinished,!1)},downloadFinished:function(){this.$modal.closeLoading()},handleCaptureScrren:function(){var e=this;Object(l["a"])().then((function(t){200===t.code?(e.msgSuccess("截屏成功"),e.getList()):e.msgError("截屏失败")}))},fileSizeFormat:function(e){return Object(s["d"])(parseInt(e.length))},handleDeleteFile:function(){var e=this,t={operateType:c,srcFileList:this.ids};Object(o["c"])(t).then((function(t){200===t.code?(e.msgSuccess("操作成功"),e.getList()):e.msgError("操作失败")}))},onShowOnline:function(e){this.nextPlayFile=e;var t=[];t.push(e.filePath),r["a"].startDownload(t,"media","audio",null,this.OnShowReady,!1,null,!0)},OnShowReady:function(e){this.playFile.name=this.nextPlayFile.name,this.playFile.url=e,this.playFile.show=!0}}},u=d,m=a("2877"),p=Object(m["a"])(u,n,i,!1,null,null,null);t["default"]=p.exports}}]);