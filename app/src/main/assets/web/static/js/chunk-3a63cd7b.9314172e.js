(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a63cd7b"],{"104b":function(e,a,t){"use strict";t("d3b7"),t("3ca3"),t("ddb0"),t("2b3d"),t("9861");var o=t("ddfe"),l=t("21a6"),n={downloadInterval:2e3,downloadTimer:null,filePath:[],saveFileName:null,mainType:null,subType:null,isZip:!0,callback:null,packageCallback:null,autoDownload:!0,downloadFile:function(){Object(o["a"])(n.filePath,n.isZip,n.mainType,n.subType).then((function(e){var a="application/zip";"media"===n.mainType&&"audio"===n.subType?a="audio/mp3":"media"===n.mainType&&"video"===n.subType?a="audio/mp4":"media"===n.mainType&&"image"===n.subType&&(a="image/png");var t=new Blob([e],{type:a});n.saveFileName&&Object(l["saveAs"])(t,n.saveFileName),n.callback&&n.callback(n.saveFileName?n.saveFileName:window.URL.createObjectURL(t))}))},doPackageFile:function(){var e=this;Object(o["d"])(n.filePath,n.isZip,n.mainType,n.subType).then((function(a){a.code&&(200!=a.code?e.msgError(a.msg):(n.filePath=[],n.filePath.push(a.data.filePath),a.data.ready?(n.packageCallback&&n.packageCallback(a.data),n.autoDownload&&n.downloadFile()):n.startDownloadTimer()))}))},startDownload:function(e,a,t,o,l){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];n.filePath=e,n.isZip=i,n.mainType=a,n.subType=t,n.saveFileName=o,n.callback=l,n.packageCallback=r,n.autoDownload=s,n.doPackageFile()},startDownloadTimer:function(){null==n.downloadTimer&&setTimeout((function(){n.doPackageFile()}),n.downloadInterval)}};a["a"]=n},c6ee:function(e,a,t){"use strict";t.r(a);var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"app-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tables",attrs:{data:e.list},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"名称模块",align:"center",prop:"logType"}}),t("el-table-column",{attrs:{label:"保存目录",align:"center",prop:"logDir"}}),t("el-table-column",{attrs:{label:"最长保存时间（ms）",align:"center",prop:"maxKeepTime"}}),t("el-table-column",{attrs:{label:"最大文件数量",align:"center",prop:"maxFileCount"}}),t("el-table-column",{attrs:{label:"最大单个文件大小（kb）",align:"center",prop:"maxFileCount"}}),t("el-table-column",{attrs:{label:"是否开启",align:"center",prop:"open",formatter:e.openTypeFormat}}),t("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handleView(a.row)}}},[e._v("详细")]),t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-download"},on:{click:function(t){return e.downloadLog(a.row)}}},[e._v("下载")])]}}])})],1),t("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(a){return e.$set(e.queryParams,"pageNum",a)},"update:limit":function(a){return e.$set(e.queryParams,"pageSize",a)},pagination:e.getList}}),t("el-dialog",{attrs:{title:"日志配置",visible:e.open,width:"700px","append-to-body":""},on:{"update:visible":function(a){e.open=a}}},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",size:"mini"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"模块名称："}},[e._v(e._s(e.form.logType)+" ")]),t("el-form-item",{attrs:{label:"日志目录："}},[t("el-input",{attrs:{placeholder:"日志目录："},model:{value:e.form.logDir,callback:function(a){e.$set(e.form,"logDir",a)},expression:"form.logDir"}})],1),t("el-form-item",{attrs:{label:"最长保存时间（ms）："}},[t("el-input",{attrs:{placeholder:"最长保存时间（ms）："},model:{value:e.form.maxKeepTime,callback:function(a){e.$set(e.form,"maxKeepTime",a)},expression:"form.maxKeepTime"}})],1),t("el-form-item",{attrs:{label:"最大文件数量："}},[t("el-input",{attrs:{placeholder:"最大文件数量："},model:{value:e.form.maxFileCount,callback:function(a){e.$set(e.form,"maxFileCount",a)},expression:"form.maxFileCount"}})],1),t("el-form-item",{attrs:{label:"最大单个文件大小（kb）："}},[t("el-input",{attrs:{placeholder:"最大单个文件大小（kb）："},model:{value:e.form.maxFileSize,callback:function(a){e.$set(e.form,"maxFileSize",a)},expression:"form.maxFileSize"}})],1),t("el-form-item",{attrs:{label:"状态："}},[t("el-radio-group",{model:{value:e.form.open,callback:function(a){e.$set(e.form,"open",a)},expression:"form.open"}},e._l(e.statusOptions,(function(a){return t("el-radio",{key:a.value,attrs:{label:a.value}},[e._v(e._s(a.label))])})),1)],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),t("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},l=[],n=t("5530"),i=(t("d81d"),t("70f0"));function r(e){var a={commandId:"maintain-req-log-get-config",data:{logType:e}};return Object(i["a"])({url:"/maintain/custom",method:"post",data:a})}function s(e){var a={commandId:"maintain-req-log-set-config",data:[]};return a.data.push(e),Object(i["a"])({url:"/maintain/custom",method:"post",data:a})}var c=t("104b"),u={name:"configLog",data:function(){return{loading:!0,ids:[],multiple:!0,showSearch:!0,total:0,list:[],open:!1,dateRange:[],defaultSort:{prop:"operTime",order:"descending"},form:{},queryParams:{pageNum:1,pageSize:10,title:void 0,operName:void 0,businessType:void 0,status:void 0},sys_oper_type:[{value:0,label:"app"},{value:1,label:"web"}],sys_common_status:[{value:0,label:"失败"},{value:1,label:"成功"}],statusOptions:[{value:!1,label:"关闭"},{value:!0,label:"开启"}]}},created:function(){this.getList()},methods:{getList:function(){var e=this;r().then((function(a){console.log(a),200===a.code?e.list=a.data:e.msgError(a.msg)})),this.loading=!1},openTypeFormat:function(e,a){return e.open?"开启":"关闭"},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.operId})),this.multiple=!e.length},handleView:function(e){this.open=!0,this.form=e},handleExport:function(){this.download("monitor/operlog/export",Object(n["a"])({},this.queryParams),"operlog_".concat((new Date).getTime(),".xlsx"))},submitForm:function(){var e=this;this.$refs["form"].validate((function(a){a&&s(e.form).then((function(a){200===a.code?(e.msgSuccess("修改成功"),e.open=!1,e.getList()):e.msgError(a.msg)}))}))},cancel:function(){this.open=!1},downloadLog:function(e){var a="log.zip";this.$modal.loading("数据下载中..."),c["a"].startDownload(null,"log",e.logType,a,this.downloadFinished,!0)},downloadFinished:function(){this.$modal.closeLoading()}}},m=u,d=t("2877"),p=Object(d["a"])(m,o,l,!1,null,null,null);a["default"]=p.exports},ddfe:function(e,a,t){"use strict";t.d(a,"b",(function(){return l})),t.d(a,"a",(function(){return n})),t.d(a,"d",(function(){return i})),t.d(a,"c",(function(){return r}));var o=t("70f0");function l(e,a,t,l){var n={commandId:"maintain-req-get-file-list",data:{dir:e,mainType:a,subType:t,withDir:l}};return Object(o["a"])({url:"/maintain/custom",method:"post",data:n})}function n(e,a,t,l){var n={fileList:e,zipAll:a,mainType:t,subType:l};return Object(o["a"])({url:"/file/download",method:"post",data:n,responseType:"blob"})}function i(e,a,t,l){var n={fileList:e,zipAll:a,mainType:t,subType:l},i={commandId:"maintain-req-package-file",data:n};return Object(o["a"])({url:"/maintain/custom",method:"post",data:i})}function r(e){var a={commandId:"maintain-req-operate-file",data:e};return Object(o["a"])({url:"/maintain/custom",method:"post",data:a})}}}]);