(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ecee9d10"],{"04d1":function(t,e,i){var a=i("342f"),s=a.match(/firefox\/(\d+)/i);t.exports=!!s&&+s[1]},2485:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"cardTitle"},[i("span",[t._v(t._s(t.cardName))]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success",plain:""},on:{click:t.handleAddTimeSlot}},[t._v("添加时段")]),t.saveBySelf?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:""},on:{click:t.handleSubmit}},[t._v("保存设置")]):t._e()],1),t._l(t.timeSlotList,(function(e,a){return i("div",{key:a,staticClass:"timeSlotItem"},[i("time-slot-card",{attrs:{timeSlot:e,cardIndex:a},on:{onDeleteTimeSlot:t.handleDelTimeSlot}})],1)}))],2)},s=[],r=(i("a9e3"),i("a434"),i("70f0")),n=i("b0bd");function o(t,e,i){var a={currentPage:t,pageSize:e,timeSlotType:i};return Object(r["a"])({url:"/business/custom",method:"post",data:Object(n["a"])("req-list-time-slot",a)})}function u(t,e){var i={updateType:0,totalLength:t.length,list:t},a={responseList:i,timeSlotType:e};return Object(r["a"])({url:"/business/custom",method:"post",data:Object(n["a"])("req-update-time-slot",a)})}var l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",[i("span",[t._v("启 用：")]),i("el-checkbox",{on:{change:t.handleStateChange},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}}),i("el-button",{staticStyle:{float:"right"},attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:t.handleDelete}})],1),i("div",{staticClass:"columnSpan"},[i("span",[t._v("时间范围：")]),i("el-time-picker",{attrs:{"is-range":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围",format:"HH:mm:ss"},on:{change:t.handleTimeSpanChange},model:{value:t.timePicker,callback:function(e){t.timePicker=e},expression:"timePicker"}})],1),i("div",{staticClass:"columnSpan"},[i("span",[t._v("执行周期：")]),i("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.allPeriod,callback:function(e){t.allPeriod=e},expression:"allPeriod"}},[t._v("全选")]),i("el-checkbox-group",{staticClass:"columnSpan",on:{change:t.handleCheckedPeriodsChange},model:{value:t.periodList,callback:function(e){t.periodList=e},expression:"periodList"}},t._l(t.periodOptions,(function(e){return i("el-checkbox",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])})),1)],1)])},c=[],d=(i("b65f"),i("ac1f"),i("1276"),i("4e82"),i("d3b7"),i("159b"),36e5),m=6e4,h=2022,p=9,f=6,S={name:"timeSlotSettings",components:{},props:{timeSlot:{type:Object,default:function(){return{startTime:1081e4,endTime:1084e4,period:"0,1,2,3,4,5,6,7",state:1,type:1}}},cardIndex:{type:Number,default:0}},data:function(){return{periodOptions:[{value:"0",label:"周日"},{value:"1",label:"周一"},{value:"2",label:"周二"},{value:"3",label:"周三"},{value:"4",label:"周四"},{value:"5",label:"周五"},{value:"6",label:"周六"}],isIndeterminate:!0,allPeriod:!0,periodList:[],timePicker:[],state:0}},created:function(){this.convertTimeSlot()},watch:{timeSlot:function(t){this.convertTimeSlot()}},methods:{timeFormater:function(t){var e=Math.trunc(t/d);t%=d;var i=Math.trunc(t/m);return new Date(h,p,f,e,i)},convertTimeSlot:function(){this.state=1===this.timeSlot.state;var t=[this.timeFormater(this.timeSlot.startTime),this.timeFormater(this.timeSlot.endTime)];this.timePicker=t,this.timeSlot.period?this.periodList=this.timeSlot.period.split(","):this.periodList=[],"0,1,2,3,4,5,6,7"===this.timeSlot.period?this.allPeriod=!0:this.allPeriod=!1},handleCheckAllChange:function(t){t?(this.timeSlot.period="0,1,2,3,4,5,6",this.periodList=["0","1","2","3","4","5","6"]):(this.timeSlot.period="",this.periodList=[]),this.isIndeterminate=!1},handleCheckedPeriodsChange:function(t){var e=t.length;this.allPeriod=e===this.periodOptions.length,this.isIndeterminate=e>0&&e<this.periodOptions.length;var i="";e>0&&(t.sort((function(t,e){return t-e})),t.forEach((function(t,e){e>0&&(i+=","),i+=t}))),this.timeSlot.period=i},handleStateChange:function(t){this.timeSlot.state=t?1:0},handleTimeSpanChange:function(t){var e=t[0],i=t[1];this.timeSlot.startTime=e.getHours()*d+e.getMinutes()*m,this.timeSlot.endTime=i.getHours()*d+i.getMinutes()*m},handleDelete:function(){this.$emit("onDeleteTimeSlot",this.cardIndex)}}},v=S,b=(i("6ad0"),i("2877")),g=Object(b["a"])(v,l,c,!1,null,"29fa8c38",null),T=g.exports,y={name:"timeSlotSettings",components:{TimeSlotCard:T},props:{cardName:{type:String,default:"卡片名称"},timeSlotType:{type:Number,default:0},saveBySelf:{type:Boolean,default:!0}},data:function(){return{timeSlotList:[],queryParams:{pageNum:1,pageSize:100}}},created:function(){this.getList()},methods:{getList:function(){var t=this;o(this.queryParams.pageNum,this.queryParams.pageSize,this.timeSlotType).then((function(e){200===e.code&&(t.timeSlotList=e.data.list)}))},handleAddTimeSlot:function(){var t={startTime:324e5,endTime:36e6,period:"0,1,2,3,4,5,6,7",state:1,type:this.timeSlotType};this.timeSlotList.push(t)},handleDelTimeSlot:function(t){this.timeSlotList.splice(t,1)},handleSubmit:function(){var t=this;u(this.timeSlotList,this.timeSlotType).then((function(e){t.saveBySelf&&(200===e.code?t.msgSuccess("时间段修改成功"):t.msgError("时间段修改失败"))}))}}},k=y,N=(i("4059"),Object(b["a"])(k,a,s,!1,null,"0d2222ca",null));e["a"]=N.exports},"333c":function(t,e,i){},4059:function(t,e,i){"use strict";i("67f5")},"4e82":function(t,e,i){"use strict";var a=i("23e7"),s=i("e330"),r=i("59ed"),n=i("7b0b"),o=i("07fa"),u=i("577e"),l=i("d039"),c=i("addb"),d=i("a640"),m=i("04d1"),h=i("d998"),p=i("2d00"),f=i("512ce"),S=[],v=s(S.sort),b=s(S.push),g=l((function(){S.sort(void 0)})),T=l((function(){S.sort(null)})),y=d("sort"),k=!l((function(){if(p)return p<70;if(!(m&&m>3)){if(h)return!0;if(f)return f<603;var t,e,i,a,s="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(a=0;a<47;a++)S.push({k:e+a,v:i})}for(S.sort((function(t,e){return e.v-t.v})),a=0;a<S.length;a++)e=S[a].k.charAt(0),s.charAt(s.length-1)!==e&&(s+=e);return"DGBEFHACIJK"!==s}})),N=g||!T||!y||!k,x=function(t){return function(e,i){return void 0===i?-1:void 0===e?1:void 0!==t?+t(e,i)||0:u(e)>u(i)?1:-1}};a({target:"Array",proto:!0,forced:N},{sort:function(t){void 0!==t&&r(t);var e=n(this);if(k)return void 0===t?v(e):v(e,t);var i,a,s=[],u=o(e);for(a=0;a<u;a++)a in e&&b(s,e[a]);c(s,x(t)),i=s.length,a=0;while(a<i)e[a]=s[a++];while(a<u)delete e[a++];return e}})},"512ce":function(t,e,i){var a=i("342f"),s=a.match(/AppleWebKit\/(\d+)\./);t.exports=!!s&&+s[1]},6694:function(t,e,i){"use strict";i("b28b")},"67f5":function(t,e,i){},"6ad0":function(t,e,i){"use strict";i("333c")},addb:function(t,e,i){var a=i("f36a"),s=Math.floor,r=function(t,e){var i=t.length,u=s(i/2);return i<8?n(t,e):o(t,r(a(t,0,u),e),r(a(t,u),e),e)},n=function(t,e){var i,a,s=t.length,r=1;while(r<s){a=r,i=t[r];while(a&&e(t[a-1],i)>0)t[a]=t[--a];a!==r++&&(t[a]=i)}return t},o=function(t,e,i,a){var s=e.length,r=i.length,n=0,o=0;while(n<s||o<r)t[n+o]=n<s&&o<r?a(e[n],i[o])<=0?e[n++]:i[o++]:n<s?e[n++]:i[o++];return t};t.exports=r},b0bd:function(t,e,i){"use strict";function a(t,e){var i={deviceType:7,deviceId:null,parentNo:null,phoneNo:null,commandId:t,ipAddress:null,macAddress:null,data:e};return i}i.d(e,"a",(function(){return a}))},b28b:function(t,e,i){},b65f:function(t,e,i){var a=i("23e7"),s=Math.ceil,r=Math.floor;a({target:"Math",stat:!0},{trunc:function(t){return(t>0?r:s)(t)}})},d625:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"cardTitle"},[i("span",[t._v("托管主机设置")]),0==t.deviceStatus.trustState?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:""},on:{click:t.handleSubmit}},[t._v("保存设置")]):t._e(),2==t.deviceStatus.trustState?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success",plain:""},on:{click:function(e){return t.handleRequestTrust(!0)}}},[t._v("停止托管")]):t._e()],1),1==t.deviceStatus.trustState||3==t.deviceStatus.trustState?i("span",[t._v("（当前正在进行托管请求，不可进行配置更改操作）")]):t._e(),i("div",{staticStyle:{display:"flex","margin-top":"20px"}},[i("span",{staticClass:"masterTitle"},[t._v("托管主机编号：")]),i("el-input",{staticStyle:{width:"80px"},attrs:{type:"number",disabled:2==t.deviceStatus.trustState,max:"1000",min:"100"},on:{blur:t.checkNumber},model:{value:t.trustNo,callback:function(e){t.trustNo=e},expression:"trustNo"}})],1),0==t.deviceStatus.trustState?i("div",{staticStyle:{display:"flex","margin-top":"20px"}},[i("span",[t._v("启用指定时间段自动托管：")]),i("el-checkbox",{model:{value:t.autoTrust,callback:function(e){t.autoTrust=e},expression:"autoTrust"}})],1):t._e(),t.autoTrust&&0==t.deviceStatus.trustState?i("time-slot-settings",{ref:"timeSlotSettingsRef",staticStyle:{"margin-top":"20px"},attrs:{cardName:t.timeSlotCardName,timeSlotType:t.timeSlotType,saveBySelf:t.timeSlotSaveBySelf}}):t._e()],1)},s=[],r=(i("d3b7"),i("159b"),i("2485")),n=i("dc14"),o=i("f610"),u=i("70f0"),l=i("b0bd");function c(t){return Object(u["a"])({url:"/business/custom",method:"post",data:Object(l["a"])("req-trust",t)})}var d=1,m=2,h=4,p=2,f=0,S=1,v=2,b=3,g=1,T=0,y={name:"trustMaster",components:{TimeSlotSettings:r["a"]},data:function(){return{timeSlotType:p,timeSlotCardName:"自动托管时段设置",masterSelf:"",trustNo:"",queryParams:{pageNum:1,pageSize:100},orgStepMasterList:[],timeSlotSaveBySelf:!1,intervalTime:1e4,timerInterval:null,deviceStatus:{trustState:1,workState:0},autoTrust:null,changedSomething:!1,controlBtnName:"开启托管功能"}},created:function(){this.getStatus(),this.startTimer(),this.getList()},methods:{startTimer:function(){var t=this;this.timerInterval||(this.timerInterval=setInterval((function(){t.getStatus()}),this.intervalTime))},getStatus:function(){var t=this;Object(o["b"])().then((function(e){200===e.code&&(t.deviceStatus.trustState=e.data.trustState,t.deviceStatus.workState=e.data.workState,null==t.autoTrust&&(t.autoTrust=e.data.autoTrust))}))},handleRequestTrust:function(t){var e=this;if(this.trustNo){var i={beTrustNo:this.masterSelf,trustNo:this.trustNo,state:g,autoTrust:this.autoTrust};this.deviceStatus.trustState===f?(i.state=g,this.autoTrust||(this.deviceStatus.trustState=S)):this.deviceStatus.trustState===v&&(i.state=T,this.autoTrust||(this.deviceStatus.trustState=b)),c(i).then((function(i){200==i.code?t&&e.msgSuccess("操作成功"):t&&e.msgSuccess("操作失败")}))}else this.msgError("托管主机号不能为空")},getList:function(){var t=this;Object(n["a"])(this.queryParams.pageNum,this.queryParams.pageSize,null).then((function(e){200===e.code&&(t.masterSelf=e.data.masterNo,t.orgStepMasterList=e.data.list,t.orgStepMasterList&&t.orgStepMasterList.forEach((function(e){e.masterType===h&&(t.trustNo=e.masterNo)})))}))},checkNumber:function(){if(this.trustNo){var t=parseInt(this.trustNo);t=t<=100?100:t,t=t>=1e3?999:t}this.changedSomething=!0,this.trustNo=toString(val)},preCheck:function(){if(this.trustNo){if(parseInt(this.trustNo)===parseInt(this.masterSelf))return this.msgError("托管主机不能是本机"),!1;for(var t in this.orgStepMasterList){var e=this.orgStepMasterList[t];if((e.masterType==m||e.masterType==d)&&parseInt(this.trustNo)===parseInt(e.masterNo))return e.masterType==m?(this.msgError("托管主机不能是附加主机"),!1):(this.msgError("托管主机不能是备用主机"),!1)}}return!0},handleSubmit:function(){var t=this;if(this.preCheck()){var e=[],i={masterNo:this.trustNo,masterLevel:0,callWaitTime:0,masterType:h};e.push(i),this.autoTrust&&this.$refs.timeSlotSettingsRef.handleSubmit(),Object(n["b"])(e,h).then((function(e){200===e.code?(t.handleRequestTrust(!1),t.msgSuccess("托管主机设置成功")):t.msgError("托管主机设置失败")}))}}}},k=y,N=(i("6694"),i("2877")),x=Object(N["a"])(k,a,s,!1,null,null,null);e["default"]=x.exports},d998:function(t,e,i){var a=i("342f");t.exports=/MSIE|Trident/.test(a)},dc14:function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return n}));var a=i("70f0"),s=i("b0bd");function r(t,e,i){var r={currentPage:t,pageSize:e,stepMasterType:i};return Object(a["a"])({url:"/business/custom",method:"post",data:Object(s["a"])("req-list-step-master",r)})}function n(t,e){var i={updateType:0,totalLength:t.length,list:t},r={responseList:i,stepMasterType:e};return Object(a["a"])({url:"/business/custom",method:"post",data:Object(s["a"])("req-update-step-master",r)})}},f610:function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return o}));var a=i("70f0"),s=i("b0bd");function r(){var t={};return Object(a["a"])({url:"/business/custom",method:"post",data:Object(s["a"])("req-get-device-info",t)})}function n(t){return Object(a["a"])({url:"/business/custom",method:"post",data:Object(s["a"])("req-change-device-info",t)})}function o(){var t={};return Object(a["a"])({url:"/business/custom",method:"post",data:Object(s["a"])("req-get-status",t)})}}}]);